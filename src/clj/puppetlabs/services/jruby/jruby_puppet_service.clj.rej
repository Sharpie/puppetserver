***************
*** 18,32 ****
                            [[:ConfigService get-config]
                             [:ShutdownService shutdown-on-error]
                             [:PuppetProfilerService get-profiler]
                             [:PoolManagerService create-pool]]
    (init
      [this context]
      (log/info (i18n/trs "Initializing the JRuby service"))
-     (let [jruby-config (core/initialize-and-create-jruby-config
                          (get-config)
                          (get-profiler)
                          (partial shutdown-on-error (tk-services/service-id this))
-                         true)
            _ (core/add-facter-jar-to-system-classloader! (:ruby-load-path jruby-config))
            pool-context (create-pool jruby-config)]
        (-> context
--- 18,35 ----
                            [[:ConfigService get-config]
                             [:ShutdownService shutdown-on-error]
                             [:PuppetProfilerService get-profiler]
+                            [:MetricsService register-tracer]
                             [:PoolManagerService create-pool]]
    (init
      [this context]
      (log/info (i18n/trs "Initializing the JRuby service"))
+     (let [tracer (register-tracer "puppet-server")
+           jruby-config (core/initialize-and-create-jruby-config
                          (get-config)
                          (get-profiler)
                          (partial shutdown-on-error (tk-services/service-id this))
+                         true
+                         tracer)
            _ (core/add-facter-jar-to-system-classloader! (:ruby-load-path jruby-config))
            pool-context (create-pool jruby-config)]
        (-> context
